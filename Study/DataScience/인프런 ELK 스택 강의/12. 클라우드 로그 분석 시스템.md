### 클라우드 로그 분석 시스템 아키텍처

ELK Stack 은 기본적으로

![image-20200112101521904](../image\image-20200112101521904.png)

ES 로그를 저장하는 DB로 활용이 됩니다.

logstash 는 클라우드 내에 발생된 로그를 전달받아 ES에 저장하는 역활 

Kibana는 로그를 브라우저로 시각화 해서 출력합니다.

ELK 가 없으면 시스템 문제 발생시 일일이 하나 하나 확인을 해야지



그럼 어떻게 Logstash는 어떻게 클라우드상에 로그정보를 입력 받을 수 있을 까요??

바로 파일비트입니다. 파일 빗은 각각의 서버에 있어서 로그 파일에 변화가 있을 때 변화된 로그 파일을 로그 stash에 전송한다.



예를들어 클라우드 상에 tomcat Server , database server 가 있으면 각각의 서버에 filebeat가 인스톨 되어 있고 로그 변화가 있을 때 logstash 로 전송합니다.

![image-20200112102009336](../image\image-20200112102009336.png)

실행시 오랜된 데이터를 삭제하지 않아서 디스크 공간문제가 발생할 수 있는데



이때 큐레이터를 사용하면 쉽게 해결 가능 합니다. 큐레이터는 손쉽게 데이터 보존 시간및 최대 데이터 량을 설정해서  ELK 스택에 디스크 공간 부족문제가 없도록 해줍니다.



![image-20200112102214319](../image\image-20200112102214319.png)

 또 우리가 한달 이상된 데이터를 삭제하는데 

한달이상된 데이터를 봐야할 경우도 생기겠죠?? 

이런경우를  대비해 매일 발생되는 로그를  S3에 저장해서 필요시 한달 이상된 로그를  ES 에 복구하고 ES 을 구현한다면 보다 완벽한 시스템이라 볼 수 있다.